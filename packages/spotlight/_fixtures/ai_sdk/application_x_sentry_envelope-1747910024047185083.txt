{"event_id":"4fd66c63ca8d4883927ef652e8fb576a","sent_at":"2025-05-22T10:33:44.039Z","sdk":{"name":"sentry.javascript.nextjs","version":"9.19.0"},"trace":{"environment":"development","release":"2a17ad245d29db80398aeec4b697de539ebfa193","public_key":"6b73db991163129e1fd5a8f85ec67c33","trace_id":"4aad454a6c23d513a463670516c1f3bd","transaction":"GET /","sampled":"true","sample_rand":"0.18640573187898335","sample_rate":"1"}}
{"type":"transaction"}
{"contexts":{"trace":{"parent_span_id":"bde8e077c30bfb0c","span_id":"7bb2090ce5c7592d","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.source":"route","sentry.op":"http.server","sentry.origin":"auto","otel.kind":"SERVER","http.response.status_code":200,"next.span_name":"POST /api/chat/route","next.span_type":"BaseServer.handleRequest","http.method":"POST","http.target":"/api/chat","http.route":"/api/chat/route","http.status_code":200,"next.rsc":false,"next.route":"/api/chat/route"},"origin":"auto","op":"http.server","status":"ok"},"otel":{"resource":{"service.name":"node","telemetry.sdk.language":"nodejs","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.30.1","service.namespace":"sentry","service.version":"9.19.0"}},"response":{"status_code":200},"runtime":{"name":"node","version":"v23.11.0"},"app":{"app_start_time":"2025-05-22T10:31:25.050Z","app_memory":1273462784,"free_memory":116129792},"os":{"kernel_version":"24.4.0","name":"macOS","version":"15.4.1","build":"24E263"},"device":{"boot_time":"2025-05-12T10:38:48.816Z","arch":"arm64","memory_size":17179869184,"free_memory":116129792,"processor_count":10,"cpu_description":"Apple M2 Pro","processor_frequency":2400},"culture":{"locale":"en-US","timezone":"Europe/Madrid"},"cloud_resource":{}},"spans":[{"span_id":"962108ec3807abf4","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"auto","next.span_name":"resolve page components","next.span_type":"NextNodeServer.findPageComponents","next.route":"/api/chat"},"description":"resolve page components","parent_span_id":"7bb2090ce5c7592d","start_timestamp":1747910023.487,"timestamp":1747910023.4878225,"status":"ok","origin":"auto"},{"span_id":"8573293266ab75de","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"auto","next.span_name":"executing api route (app) /api/chat/route","next.span_type":"AppRouteRouteHandlers.runHandler","next.route":"/api/chat/route","http.response.status_code":200},"description":"executing api route (app) /api/chat/route","parent_span_id":"7bb2090ce5c7592d","start_timestamp":1747910023.489,"timestamp":1747910023.4953182,"status":"ok","origin":"auto"},{"span_id":"ceaacfa00edd702a","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"auto","next.span_name":"start response","next.span_type":"NextNodeServer.startResponse"},"description":"start response","parent_span_id":"8573293266ab75de","start_timestamp":1747910023.87,"timestamp":1747910023.8702621,"status":"ok","origin":"auto"},{"span_id":"56d4c7ade576a7fc","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"manual","operation.name":"ai.streamText Weather-Function","resource.name":"Weather-Function","ai.operationId":"ai.streamText","ai.telemetry.functionId":"Weather-Function","ai.model.provider":"openai.chat","ai.model.id":"gpt-4.1-nano-2025-04-14","ai.settings.maxRetries":2,"ai.telemetry.metadata.weatherCustomKey":"custom value","ai.telemetry.metadata.weatherOtherKey":"other value","ai.prompt":"{\"system\":\"You are a helpful assistant.\",\"messages\":[{\"role\":\"user\",\"content\":\"weather in sf\",\"parts\":[{\"type\":\"text\",\"text\":\"weather in sf\"}]},{\"role\":\"assistant\",\"content\":\"\",\"toolInvocations\":[{\"state\":\"result\",\"step\":0,\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"toolName\":\"getLocation\",\"args\":{\"city\":\"San Francisco\"},\"result\":{\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"result\":\"Your location is at latitude 37.7749 and longitude -122.4194\"}}],\"parts\":[{\"type\":\"step-start\"},{\"type\":\"tool-invocation\",\"toolInvocation\":{\"state\":\"result\",\"step\":0,\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"toolName\":\"getLocation\",\"args\":{\"city\":\"San Francisco\"},\"result\":{\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"result\":\"Your location is at latitude 37.7749 and longitude -122.4194\"}}}]}]}","ai.settings.maxSteps":1,"ai.response.finishReason":"tool-calls","ai.response.text":"","ai.response.toolCalls":"[{\"type\":\"tool-call\",\"toolCallId\":\"call_D9DXWmd6iMrN8171RIDB7qeU\",\"toolName\":\"getWeather\",\"args\":{\"lat\":37.7749,\"lon\":-122.4194,\"unit\":\"F\"}}]","ai.usage.promptTokens":181,"ai.usage.completionTokens":29},"description":"ai.streamText","parent_span_id":"8573293266ab75de","start_timestamp":1747910023.492,"timestamp":1747910024.0323029,"status":"ok","origin":"manual"},{"span_id":"524f08cfd6f99bdf","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"manual","operation.name":"ai.toolCall Weather-Function","resource.name":"Weather-Function","ai.operationId":"ai.toolCall","ai.telemetry.functionId":"Weather-Function","ai.toolCall.name":"getWeather","ai.toolCall.id":"call_D9DXWmd6iMrN8171RIDB7qeU","ai.toolCall.args":"{\"lat\":37.7749,\"lon\":-122.4194,\"unit\":\"F\"}","ai.toolCall.result":"{\"toolCallId\":\"call_D9DXWmd6iMrN8171RIDB7qeU\",\"result\":\"It is currently 25Â°F and Sunny!\"}"},"description":"ai.toolCall","parent_span_id":"56d4c7ade576a7fc","start_timestamp":1747910024.015,"timestamp":1747910024.0163083,"status":"ok","origin":"manual"},{"span_id":"719d62c3027677b4","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"manual","operation.name":"ai.streamText.doStream Weather-Function","resource.name":"Weather-Function","ai.operationId":"ai.streamText.doStream","ai.telemetry.functionId":"Weather-Function","ai.model.provider":"openai.chat","ai.model.id":"gpt-4.1-nano-2025-04-14","ai.settings.maxRetries":2,"ai.telemetry.metadata.weatherCustomKey":"custom value","ai.telemetry.metadata.weatherOtherKey":"other value","ai.prompt.format":"messages","ai.prompt.messages":"[{\"role\":\"system\",\"content\":\"You are a helpful assistant.\"},{\"role\":\"user\",\"content\":[{\"type\":\"text\",\"text\":\"weather in sf\"}]},{\"role\":\"assistant\",\"content\":[{\"type\":\"tool-call\",\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"toolName\":\"getLocation\",\"args\":{\"city\":\"San Francisco\"}}]},{\"role\":\"tool\",\"content\":[{\"type\":\"tool-result\",\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"toolName\":\"getLocation\",\"result\":{\"toolCallId\":\"call_IN3lxRowFHDja2sEuJaJMa9q\",\"result\":\"Your location is at latitude 37.7749 and longitude -122.4194\"}}]}]","ai.prompt.tools":["{\"type\":\"function\",\"name\":\"getLocation\",\"description\":\"Get the location of the user\",\"parameters\":{\"type\":\"object\",\"properties\":{\"city\":{\"type\":\"string\",\"description\":\"The city to get coordinates for\"}},\"required\":[\"city\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}}","{\"type\":\"function\",\"name\":\"getWeather\",\"description\":\"Get the weather for a location\",\"parameters\":{\"type\":\"object\",\"properties\":{\"lat\":{\"type\":\"number\",\"description\":\"The latitude of the location\"},\"lon\":{\"type\":\"number\",\"description\":\"The longitude of the location\"},\"unit\":{\"type\":\"string\",\"enum\":[\"C\",\"F\"],\"description\":\"The unit to display the temperature in\"}},\"required\":[\"lat\",\"lon\",\"unit\"],\"additionalProperties\":false,\"$schema\":\"http://json-schema.org/draft-07/schema#\"}}"],"ai.prompt.toolChoice":"{\"type\":\"auto\"}","gen_ai.system":"openai.chat","gen_ai.request.model":"gpt-4.1-nano-2025-04-14","ai.response.msToFirstChunk":375.4111659999762,"ai.response.msToFinish":537.565082999994,"ai.response.avgCompletionTokensPerSecond":53.946956223717976,"ai.response.finishReason":"tool-calls","ai.response.text":"","ai.response.toolCalls":"[{\"type\":\"tool-call\",\"toolCallId\":\"call_D9DXWmd6iMrN8171RIDB7qeU\",\"toolName\":\"getWeather\",\"args\":{\"lat\":37.7749,\"lon\":-122.4194,\"unit\":\"F\"}}]","ai.response.id":"chatcmpl-BZxX5ytEWlYBAhNIBg4p7E0kVCNO0","ai.response.model":"gpt-4.1-nano-2025-04-14","ai.response.timestamp":"2025-05-22T10:33:43.000Z","ai.usage.promptTokens":181,"ai.usage.completionTokens":29,"gen_ai.response.finish_reasons":["tool-calls"],"gen_ai.response.id":"chatcmpl-BZxX5ytEWlYBAhNIBg4p7E0kVCNO0","gen_ai.response.model":"gpt-4.1-nano-2025-04-14","gen_ai.usage.input_tokens":181,"gen_ai.usage.output_tokens":29},"description":"ai.streamText.doStream","parent_span_id":"56d4c7ade576a7fc","start_timestamp":1747910023.493,"timestamp":1747910024.0309682,"status":"ok","origin":"manual","measurements":{}},{"span_id":"6fb6d7909f0972aa","trace_id":"4aad454a6c23d513a463670516c1f3bd","data":{"sentry.origin":"auto.http.otel.node_fetch","sentry.op":"http.client","http.request.method":"POST","http.request.method_original":"POST","url.full":"https://api.openai.com/v1/chat/completions","url.path":"/v1/chat/completions","url.query":"","url.scheme":"https","server.address":"api.openai.com","server.port":443,"user_agent.original":"node","network.peer.address":"162.159.140.245","network.peer.port":443,"http.response.status_code":200,"url":"https://api.openai.com/v1/chat/completions","otel.kind":"CLIENT"},"description":"POST https://api.openai.com/v1/chat/completions","parent_span_id":"719d62c3027677b4","start_timestamp":1747910023.495,"timestamp":1747910024.030157,"status":"ok","op":"http.client","origin":"auto.http.otel.node_fetch"}],"start_timestamp":1747910023.481,"timestamp":1747910024.0335674,"transaction":"POST /api/chat","type":"transaction","transaction_info":{"source":"route"},"platform":"node","server_name":"GX9JW29J4Q.local","event_id":"4fd66c63ca8d4883927ef652e8fb576a","environment":"development","release":"2a17ad245d29db80398aeec4b697de539ebfa193","sdk":{"integrations":["InboundFilters","FunctionToString","LinkedErrors","RequestData","Console","NodeFetch","OnUncaughtException","OnUnhandledRejection","ContextLines","LocalVariablesAsync","Context","ChildProcess","ProcessSession","Modules","Express","Fastify","Graphql","Mongo","Mongoose","Mysql","Mysql2","Redis","Postgres","Prisma","Hapi","Koa","Connect","Tedious","GenericPool","Kafka","Amqplib","LruMemoizer","VercelAI","Http","DistDirRewriteFrames","Spotlight"],"name":"sentry.javascript.nextjs","version":"9.19.0","packages":[{"name":"npm:@sentry/nextjs","version":"9.19.0"},{"name":"npm:@sentry/node","version":"9.19.0"}]},"breadcrumbs":[{"timestamp":1747909888.259,"category":"console","data":{"arguments":[" \u001b[32m\u001b[1mâ\u001b[22m\u001b[39m Ready in 2.9s"],"logger":"console"},"level":"log","message":" \u001b[32m\u001b[1mâ\u001b[22m\u001b[39m Ready in 2.9s"},{"timestamp":1747909888.3,"category":"http","data":{"status_code":204,"url":"https://telemetry.nextjs.org/api/v1/record","http.method":"POST"},"type":"http"}],"request":{"headers":{"host":"localhost:3000","connection":"keep-alive","content-length":"775","sentry-trace":"4aad454a6c23d513a463670516c1f3bd-bde8e077c30bfb0c-1","sec-ch-ua-platform":"\"macOS\"","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36","sec-ch-ua":"\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"","content-type":"application/json","sec-ch-ua-mobile":"?0","baggage":"sentry-environment=development,sentry-release=2a17ad245d29db80398aeec4b697de539ebfa193,sentry-public_key=6b73db991163129e1fd5a8f85ec67c33,sentry-trace_id=4aad454a6c23d513a463670516c1f3bd,sentry-transaction=GET%20%2F,sentry-sampled=true,sentry-sample_rand=0.18640573187898335,sentry-sample_rate=1","accept":"*/*","origin":"http://localhost:3000","sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty","referer":"http://localhost:3000/","accept-encoding":"gzip, deflate, br, zstd","accept-language":"en-GB,en-US;q=0.9,en;q=0.8"},"method":"POST","url":"http://localhost:3000/api/chat","cookies":{}},"modules":{}}